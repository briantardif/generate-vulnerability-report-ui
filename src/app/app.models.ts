export interface Vulnerability {
  CVES: CVE;
  CVSS3SCORE: number;
  FINDINGID: number;
  IMAGEDIGEST: string;
  PACKAGES: PACKAGES;
  REGISTRYRESOURCEID: string;
  REGISTRYRESOURCENAME: string;
  REPOSITORY: string;
}

export interface CVE {
  cves: {
    link: string;
    title: string;
  }[];
}

export interface PACKAGES {
  packages: {
    fixedVersion: string;
    installedVersion: string;
    name: string;
  }[];
}

export interface VulnerabilityReport {
  vulnerabilitiesBySeverity: {
    criticals: {
      count: number;
      vulnerabilities: {
        [envName: string]: {
          vulnerabilities: Vulnerability[]
        }
      };
    };
    highs: {
      count: number;
      vulnerabilities: {
        [envName: string]: {
          vulnerabilities: Vulnerability[]
        }
      };
    };
    mediums: {
      count: number;
      vulnerabilities: {
        [envName: string]: {
          vulnerabilities: Vulnerability[]
        }
      };
    };
    lows: {
      count: number;
      vulnerabilities: {
        [envName: string]: {
          vulnerabilities: Vulnerability[]
        }
      };
    };
  },
  vulnerabilitiesByCve: {
    [cveName: string]: {
      cveName: string;
      count: number;
      vulnerabilities: {
        [envName: string]: {
          vulnerabilities: Vulnerability[]
        }
      };
    }
  },
  vulnerabilitiesByPackage: {
    [packageName: string]: {
      packageName: string;
      count: number;
      vulnerabilities: {
        [envName: string]: {
          vulnerabilities: Vulnerability[]
        }
      };
    }
  },
  vulnerabilitiesByRepo: {
    [repository: string]: {
      repository: string;
      count: number;
      vulnerabilities: {
        [envName: string]: {
          vulnerabilities: Vulnerability[]
        }
      };
    }
  },
  vulnerabilitiesByEnvironment: {
    [envName: string]: {
      environment: string;
      count: number;
      vulnerabilities: {
        [repoName: string]: {
          vulnerabilities: Vulnerability[]
        }
      };
    }
  }
}
